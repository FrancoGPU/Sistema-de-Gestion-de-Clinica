<!-- HEADER REDESIGNED -->
<header class="medicore-header">
  <div class="header-container">
    <!-- Logo -->
    <a class="header-logo" routerLink="/MediCore">
      <i class="fas fa-heartbeat logo-icon"></i>
      <span class="logo-text">MEDICORE</span>
    </a>

    <!-- Navigation Links -->
    <nav class="header-nav">
      <a routerLink="/MediCore" routerLinkActive="active" class="nav-link"
        >Inicio</a
      >
      <a
        routerLink="/MediCore/servicios"
        routerLinkActive="active"
        class="nav-link"
        >Servicios</a
      >
      <a
        routerLink="/MediCore/especialidades"
        routerLinkActive="active"
        class="nav-link"
        >Especialidades</a
      >
      <a routerLink="/MediCore/citas" routerLinkActive="active" class="nav-link"
        >Citas</a
      >
      <a
        routerLink="/MediCore/doctores"
        routerLinkActive="active"
        class="nav-link"
        >Doctores</a
      >
      <a
        routerLink="/MediCore/campanias"
        routerLinkActive="active"
        class="nav-link"
        >Campañas</a
      >
      <a
        routerLink="/MediCore/contacto"
        routerLinkActive="active"
        class="nav-link"
        >Contacto</a
      >
    </nav>

    <!-- Right Side Actions -->
    <div class="header-actions">
      <!-- Search Bar -->
      <div class="search-box">
        <input
          #searchInput
          type="search"
          placeholder="Buscar servicios..."
          class="search-input"
          [(ngModel)]="searchQuery"
          (keyup.enter)="search()"
        />
        <span class="search-shortcut">Ctrl K</span>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions">
        <!-- User Menu -->
        <div class="dropdown">
          <button
            class="action-btn"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            [attr.title]="isAuthenticated ? userName : 'Cuenta'"
            [attr.aria-label]="isAuthenticated ? userName : 'Cuenta'"
          >
            <i class="fas fa-user" aria-hidden="true"></i>
            <span class="visually-hidden">{{ isAuthenticated ? userName : 'Cuenta' }}</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end user-menu">
            <ng-container *ngIf="isAuthenticated">
              <li class="user-header">
                <div class="user-avatar-icon">
                  <i
                    class="fas"
                    [class.fa-user-shield]="userRole === 'Administrador'"
                    [class.fa-user]="userRole === 'Paciente'"
                  ></i>
                </div>
                <div>
                  <div class="user-name">{{ userName }}</div>
                  <div class="user-role">{{ userRole }}</div>
                </div>
              </li>
              <li><hr class="dropdown-divider" /></li>
              
              <!-- Opciones para Pacientes -->
              <ng-container *ngIf="userRole === 'Paciente'">
                <li>
                  <a
                    class="dropdown-item"
                    routerLink="/MediCore/perfil"
                    ><i class="fas fa-user-circle me-2"></i>Mi Perfil</a
                  >
                </li>
                <li>
                  <a
                    class="dropdown-item"
                    routerLink="/MediCore/mis-citas"
                    ><i class="fas fa-calendar-check me-2"></i>Mis Citas</a
                  >
                </li>
                <li>
                  <a
                    class="dropdown-item"
                    routerLink="/MediCore/historial"
                    ><i class="fas fa-file-medical me-2"></i>Historial Médico</a
                  >
                </li>
              </ng-container>

              <!-- Opciones para Administradores y Médicos -->
              <ng-container *ngIf="userRole === 'Administrador' || userRole === 'Médico'">
                <li>
                  <a
                    class="dropdown-item"
                    [routerLink]="userRole === 'Administrador' ? '/admin/index' : '/medico/dashboard'"
                    ><i class="fas fa-tachometer-alt me-2"></i>Panel de Control</a
                  >
                </li>
              </ng-container>

              <li>
                <a
                  class="dropdown-item"
                  routerLink="/MediCore/mis-mensajes"
                  ><i class="fas fa-envelope me-2"></i>Mis Mensajes</a
                >
              </li>
              <li><hr class="dropdown-divider" /></li>
              <li>
                <a
                  class="dropdown-item text-danger"
                  href="#"
                  (click)="$event.preventDefault(); logout()"
                  ><i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión</a
                >
              </li>
            </ng-container>
            <ng-container *ngIf="!isAuthenticated">
              <li>
                <a
                  class="dropdown-item"
                  href="#"
                  (click)="$event.preventDefault(); navigateToLogin()"
                  ><i class="fas fa-sign-in-alt me-2"></i>Iniciar Sesión</a
                >
              </li>
              <li>
                <a
                  class="dropdown-item"
                  href="#"
                  (click)="$event.preventDefault(); navigateToRegister()"
                  ><i class="fas fa-user-plus me-2"></i>Registrarse</a
                >
              </li>
              <li><hr class="dropdown-divider" /></li>
              <li>
                <a
                  class="dropdown-item"
                  href="#"
                  (click)="$event.preventDefault()"
                  ><i class="fas fa-question-circle me-2"></i>Ayuda</a
                >
              </li>
            </ng-container>
          </ul>
        </div>

        <!-- Phone -->
        <a href="tel:+51123456789" class="action-btn" title="Llamar a emergencias" aria-label="Llamar a emergencias">
          <i class="fas fa-phone" aria-hidden="true"></i>
        </a>

        <!-- Location -->
        <a href="https://www.google.com/maps/search/?api=1&query=Ctra.+Central+1000,+Lima+15476" target="_blank" rel="noopener noreferrer" class="action-btn" title="Ver ubicación" aria-label="Ver ubicación">
          <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        </a>

        <!-- Theme Selector -->
        <div class="dropdown">
          <button
            class="action-btn theme-btn"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            title="Cambiar tema"
            aria-label="Cambiar tema"
          >
            <i class="fas fa-sun"></i>
            <span class="visually-hidden">Cambiar tema</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li>
              <a 
                class="dropdown-item" 
                href="#" 
                (click)="$event.preventDefault(); changeTheme('light')"
              >
                <i class="fas fa-sun me-2"></i>Claro
              </a>
            </li>
            <li>
              <a 
                class="dropdown-item" 
                href="#" 
                (click)="$event.preventDefault(); changeTheme('dark')"
              >
                <i class="fas fa-moon me-2"></i>Oscuro
              </a>
            </li>
            <li>
              <a 
                class="dropdown-item" 
                href="#" 
                (click)="$event.preventDefault(); changeTheme('auto')"
              >
                <i class="fas fa-adjust me-2"></i>Auto
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Mobile Menu Toggle -->
    <button
      class="mobile-menu-toggle"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#mobileNav"
      title="Abrir menú"
      aria-label="Abrir menú"
    >
      <i class="fas fa-bars" aria-hidden="true"></i>
      <span class="visually-hidden">Abrir menú</span>
    </button>
  </div>

  <!-- Mobile Navigation -->
  <div class="collapse mobile-nav" id="mobileNav">
    <div class="mobile-nav-content">
      <a routerLink="/MediCore" class="mobile-nav-link">Inicio</a>
      <a routerLink="/MediCore/servicios" class="mobile-nav-link">Servicios</a>
      <a routerLink="/MediCore/especialidades" class="mobile-nav-link"
        >Especialidades</a
      >
      <a routerLink="/MediCore/citas" class="mobile-nav-link">Citas</a>
      <a routerLink="/MediCore/doctores" class="mobile-nav-link">Doctores</a>
      <a routerLink="/MediCore/campanias" class="mobile-nav-link">Campañas</a>
      <a routerLink="/MediCore/contacto" class="mobile-nav-link">Contacto</a>
    </div>
  </div>
</header>
